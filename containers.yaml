apiVersion: 2019-12-01
location: uksouth
name: lgDrupalContainerGroup
properties:
  containers:
  - name: nginx-drupal
    properties:
      image: ecccontainerregistry.azurecr.io/nginx-drupal:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      ports:
        - port: 443
  - name: drupal-fpm
    properties:
      image: ecccontainerregistry.azurecr.io/drupal-fpm:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      environmentVariables:
      - name: MYSQL_HOST
        value: mariadb-ecc-dev-svr.mariadb.database.azure.com
      - name: MYSQL_USER
        value: mariadb-root
      - name: MYSQL_PASSWORD
        secureValue: UbrwX+3H%B[N%g}UoR9+)y(c
      - name: MYSQL_DATABASE
        value: drupal
      volumeMounts:
      - mountPath: /drupal/web/sites/default/files
        name: filesharevol
  osType: Linux
  ipAddress:
    type: Public
    ports:
    - protocol: tcp
      port: 443
    dnsNameLabel: ecc-drupal-dev
  imageRegistryCredentials:
  - server: ecccontainerregistry.azurecr.io
    username: eccContainerRegistry
    password: OXa=67S1BesTVCcn6aDr9IagcnDynLoM
  volumes:
  - name: filesharevol
    azurefile:
      sharename: drupalshare
      storageAccountName: eccdrupalsa
      storageAccountKey: M9KeUDovFlWD0qPDG+w2T/xHC43opAbQGEvuji345XeOUAUnkI1xo9FNW1CgAcWeci4zVHldwbiW+AStVfbH2g==
tags: {owner: devops}
type: Microsoft.ContainerInstance/containerGroups